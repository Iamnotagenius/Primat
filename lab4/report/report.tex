\documentclass{article}
\usepackage[margin=5em]{geometry}
\usepackage{amsmath,amssymb,graphicx,svg}
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
\begin{document}

\begin{center}
    Национальный исследовательский университет ИТМО\\
    Факультет информационных технологий и программирования\\
    Прикладная математика
\end{center}
\vspace{20em}
\begin{center}
    {\Large — Регрессия временных рядов}
    \vspace{3pt}
    \hrule
    \vspace{3pt}
    Отчет по лабораторной работе №4
\end{center}
\vspace{15em}
\begin{flushright}
    \textbf{ Работу выполнили: } \\
    Обиджанов Алишер\\
    Казаков Андрей\\
    Кузнецов Павел\\
    \vspace{1em}
    \textbf{ Преподаватель: } \\
    Свинцов М.В
\end{flushright}
\vspace{12em}
\begin{center}
    Санкт-Петербург \\
    2024
\end{center}
\newpage


\section{Построение авторегрессионной модели}
\textbf{Авторегрессионная (AR- модель)} - модель временного ряда, в которой значения ряда зависят от предыдущих его значений.
В нашем случае мы рассматриваем AR-3 модель такого вида:
$$ x_t = a_0 + \sum_{i=1}^{3} a_i x_{t - i} + \epsilon_t $$
Где $a_i$ - коэффициенты (параметры) модели, $\epsilon_t$ - белый шум.

Нам необходимо рассмотреть стационарную модель, условие стационарности - все корни характеристического уравнения лежат вне единичной окружности.
Характеристическое уравнение имеет вид:
$$ 1 - \sum_{i=1}^3 a_i z^i = 0 $$

\section{Демонстрация регрессии ряда}
Воспользовавшись генератором авторегрессионных моделей, мы получили пример следующего ряда:
$$\input{../ar_proc.tex} + \epsilon_t$$
График первых 1003 значений ряда с первыми тремя значениями $\input{../first_members.tex}$:

\begin{figure}[h]
    \centering
    \includesvg[width=38em]{../process.svg}
\end{figure}

Как можно наблюдать из графика, ряд быстро сходится к некоторому "равновесию" вокруг значения 0, то есть ряд обладает свойством стационарности.
Колебания зависят сугубо от заданной дисперсии.

\section{Обучение модели}

Построение матрицы лагов - метод подготовки данных для прогнозирования временных рядов.  Этот метод основан на идее использования предыдущих значений временного ряда для предсказания будущих.\\

Пусть X - матрица входных данных: Каждая строка матрицы представляет собой вектор задержек (лагов) длиной \verb|lag_order|. То есть, каждая строка содержит последовательность предыдущих значений временного ряда.\\

y - вектор выходных данных. Каждый элемент вектора соответствует значению временного ряда, следующему сразу после соответствующего вектора задержек в матрице X.\\

\textbf{Пример:} Пусть у нас есть временной ряд [1,2,3,4,5] и $\verb|lag_order| = 2$. Тогда матрица X и вектор y будут следующими:

$$X = \begin{bmatrix}
        1 & 2 \\
        2 & 3 \\
        3 & 4
    \end{bmatrix}$$

$$y = \begin{bmatrix}
        3 \\
        4 \\
        5
    \end{bmatrix}$$

Далее инициализируется и обучается модель машины опорных векторов (SVM) с использованием линейного ядра. После обучения модели производится предсказание на тестовой выборке. Также оценивается качество модели с использованием среднеквадратичной ошибки

\section{График}
\begin{figure}[h]
    \centering
    \includesvg[width=38em]{../prediction_comparison_fixed.svg}\\
    \caption{}
\end{figure}

Можно заметить, что математическое ожидание предсказанных значений достаточно близко к математическому ожиданию исходного временного ряда. Однако дисперсия предсказанных значений оказывается немного меньше, чем у исходного временного ряда. Это может указывать на то, что модель в некоторой степени сглаживает колебания и шум временного ряда.

\section{Эксперементы с различными ядрами}

Эксперементы с различными ядрами и гиперпараметрами будем выполнять в цикле, где перебираются различные комбинации ядер(linear, rbf, poly), значений параметра штрафа C и степени полинома (если используется полиномиальное ядро). Для каждой комбинации параметров обучается модель машины опорных векторов (SVM), и оценивается её качество на тестовой выборке с использованием среднеквадратичной ошибки (MSE).

\end{document}
