\documentclass[fleqn]{article}
\usepackage[a4paper,margin=5em]{geometry}
\usepackage{amsmath,amssymb,tikz,pgfplots}
\usepackage[linkcolor=blue,colorlinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
\pgfplotsset{
    compat = 1.18,
    every axis/.append style = {
        axis lines = middle,
        grid = both,
        minor tick num = 1]
    },
    every axis plot/.append style = {
        samples = 1000,
        smooth
    },
    minor grid style = {
        very thin
    }
}

\begin{document}
    \begin{center}
    Национальный исследовательский университет ИТМО \\
    Факультет информационных технологий и программирования \\
    Прикладная математика и информатика
\end{center}
\vspace{20em}
\begin{center}
    {\Large Методы оптимизации}
    \vspace{3pt}
    \hrule
    \vspace{3pt}
    Отчёт по лабораторной работе №2
\end{center}
\vspace{20em}
\begin{flushright}
    \textbf{ Работу выполнили: } \\
    Казаков Андрей \\
    Обиджанов Алишер \\
    Кузнецов Павел \\

    \vspace{1em}
    \textbf{ Преподаватель: } \\
    Корсун М. М.\\

    \vspace{1em}
    \textbf{ Репозиторий: }\\
    \url{https://github.com/Iamnotagenius/Primat}
\end{flushright}
\vspace{10em}
\begin{center}
    Санкт-Петербург \\
    2023
\end{center}

\newpage

\section*{Одномерная оптимизация:}
\subsection{Постановка задачи:}
\begin{align*}
    &f(x) \rightarrow \underset{x}{min}, x \in R\\
    &f: R \rightarrow R\\
    &\underset{2[a,b]}{min}(z=f(x))
\end{align*}

\begin{itemize}
    \item [$f(x):$]
    \begin{itemize}
        \item Неприрывана
        \item Унимодальна
    \end{itemize}
\end{itemize}

Определение: Унимод на $[a, b]$  $ \exists x_* \in [a, b]$:  $f(x) [a,x_*)$ убывает, $f(x) (x_*, b]$  возрастает\\

Точность: $\varepsilon$

\subsection{Вариант задачи:}
Горный хребет: $\sin{x}*x^3$

\subsection{Решение:}
\subsubsection{Метод дихотомии}

\begin{itemize}
    \item[1)] Находим середину промежутка графика:\\
    $$\frac{a+b}{2}$$\\
    
    \item[2)] Величина отступа:\\
    $\varepsilon$ - точность\\
    $\delta$ - отступ\\
    $$\delta < \frac{\varepsilon}{2} $$\\
    
    \item[3)] Находим значения $f(x_1)$ и $f(x_2)$:\\
    $$x_1 = \frac{a_i+b_i}{2} - \delta$$\\
    $$x_2 = \frac{a_i+b_i}{2}+\delta$$\\
    
    \item[4)] Выбераем промежуток для следующей итерации\\
    Если $x_2>x_1$ : $[a, x_2],\space b_1=x_2$\\
    Если $x_1>x_2$ : $[x_1, b],\space a_1=x_1$\\
\end{itemize}

Интервал неопределённости на первой итерации:\\
$$a_2b_1 \cong a_0b_0/2$$\\
$$n:\space a_nb_n \approx \frac{b_0-a_0}{2^n}$$\\

Для того что бы достичь точность $\varepsilon$ нам потребуется столько итераций:
$$\ln{((b_0-a_0)/\varepsilon)/\ln{2}}$$

\subsubsection{Метод золотого сечения}

Метод золотого сечения позволяет вычислять значение за определённое количество итераций. Скорость линейная.

Точка $c$ делит отрезок $ab$ в соответствии золотого сечения, если $\frac{cb}{ac}=\frac{ac}{ab}$\\

В нашем случае:\\
$$\frac{x_1-a_i}{b_i-x_1}=\frac{b_i-x_1}{b_i-a_i}$$\\

\subsubsection{Метод Фибоначи}

Применяется, когда нужно определить минимум, как можно точнее, но при этом мы можем произвести только n выислений функции.\\

n - количество вычислений

Так же нам известно значение функции в точке $x_2$, $x_2\in (a,b)$

Нужно вычислить функцию всего один раз в точке $x_4$. Может быть реализован один из двух вариантов:

\begin{itemize}
    \item [1)] $x_4\in (a,x_2)$
    \item [2)] $x_4\in (x_2,b)$
\end{itemize}

Далее находим $min\{max\{(b-x_2), (x_2-a)\}\}$\\

\begin{align*}
    &L_{n-1}=2*L_n-\varepsilon\\
    &L_{n-2}=L_{n-1}+L_n\\
    &L_{j-3}=L_j+L_{j+1},\space 1<j<n
\end{align*}

Здесь можно применить числа фибоначи. Её формула:
$$F_n = \frac{1}{\sqrt{5}}((\frac{1+\sqrt{5}}{2})^n-(\frac{1-\sqrt{5}}{2})^n),\quad n=1,2,\dots$$\\

Тогда мы можем сказать, что:\\

$$x_1=a_0+\frac{F_n}{F_(n+2)}(b_0-a_0)$$
$$x_2=a_0+\frac{f_{n+1}}{f_{n+2}}(b_0-a_0)$$

На k-ом шаге метода у нас будет иметься тройка чисел: $a_k, b_k, x_k$

Они будут удовлетворять следующим условиям:
$$\delta k = b_k - a_n = (b_0-a_0)\frac{F_{n-k+3}}{F_{n+2}} \quad 1 \leq k \leq n,\quad a_1 = a_0,\quad b_1=b_0$$

$$a_k < x_k < b_k$$

$$f(x_k)=\underset{1 \geq i \geq k}{f(x_i)}$$

Останавливаемся когда $k=n$

$$\delta n = b_n - a_n = \frac{(b_0-a_0)}{F_{n+2}}$$
$$x_1 = x_2 \Rightarrow \frac{b_n - a_n}{2} = \frac{b_0-a_0}{F_{n+2}}<\varepsilon$$

$$\frac{b_0-a_0}{\varepsilon}<F_{n+2}$$

\subsubsection{Метод парабол}
Этот метод работает быстро в малой окрестности оптимального решения. Но может работать долго и неустойчиво на начальных стадиях итерационного процесса.

Пусть у нас есть квадратичная функция:
$$p(x)=ax^2+bx+c$$
А так же 3 точки:
$$x_1 < x_2 < x_3,\quad x_{min}\in[x_1,x_3]$$
Проведём нашу параболу через эти 3 точки:
$$ax^2_1+bx_i+c=f_i=f(x_i),\quad i=\overline{1,3}$$
$$u=-\frac{b}{2a}=x_2-\frac{(x_2-x_1)^2(f_2-f_3)-(x_2-x_2)^2(f_3-f_1)}{2[(x_2-x_1)(f_2-f_3)-(x_2-x_3)(f_2-f_1)]}$$

Сравнив эти точки, мы можем сократить интервал поиска. Если выполняется условие: $f_2<f_1$ И $f_2<f_3$ то точка $u$ гарантированно попадает в интервалы $x_1,\space x_3$

\subsubsection{Комбинаторный метод Бренда}
Этот метод комбенирует 2 стратегии - метод золотого сечения и метод парабол.\\

В этом методе на каждой итерации отслеживается значение в 6 сточках. Необязательно, что бы эти точки были различны.
$$a, c, x, w, v, u$$
$(a,c)$ - интревал\\
$\omega$ - 2е значение функции\\
$v$ - предыдущее значение $\omega$\\

Минимум апроксимирующий параболу $u$, принимается в качестве следующей точки оптимизационного процесса, если:\\

$u\in[a,c]$ если $[a,u]>\varepsilon$ и $[u,c]>\varepsilon$\\

Если точка $u$ отвергается, то следующая точка будет находится с помощью золотого сечения (большего из интервалов) - $max\{[a,x],[x,c]\}$\\

\subsection{Тестирование}
Тест считается пройденым, если полученный минимум отличается
от действительного на $\epsilon$.\\
Все методы смогли найти минимум унимодальной функции $x^2$.
Не один из методов не смог найти мимнимум мультимодальной функции
нашего варианта $sin(x*x^3)$ на промежутке от -10 до 10. Но
смог найти мимнимум на промежутке от -2 до 2 (на этом промежутке только один
локальный минмимум).

\end{document}