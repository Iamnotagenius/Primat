\documentclass{article}
\usepackage[a4paper,margin=5em]{geometry}
\usepackage{amsmath,amssymb,tikz,pgfplots}
\usepackage[linkcolor=blue,colorlinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
\pgfplotsset{
    compat = 1.18,
    every axis/.append style = {
        axis lines = middle,
        grid = both,
        minor tick num = 1]
    },
    every axis plot/.append style = {
        samples = 1000,
        smooth
    },
    minor grid style = {
        very thin
    }
}
\begin{document}

\begin{center}
    Национальный исследовательский университет ИТМО \\
    Факультет информационных технологий и программирования \\
    Прикладная математика и информатика
\end{center}
\vspace{20em}
\begin{center}
    {\Large Численное дифференцирование и интегрирование}
    \vspace{3pt}
    \hrule
    \vspace{3pt}
    Отчёт по лабораторной работе №1
\end{center}
\vspace{20em}
\begin{flushright}
\textbf{ Работу выполнили: } \\
Казаков Андрей \\
Обиджанов Алишер \\
Кузнецов Павел \\
\vspace{1em}
\textbf{ Преподаватель: } \\
Корсун М. М.
\end{flushright}
\vspace{12em}
\begin{center}
    Санкт-Петербург \\
    2021
\end{center}
\newpage

Выберем какую-нибудь функцию $f(x)$, определённую на отрезке $[a, b]$.
Отрезок можно разбить на $n = \frac{b-a}{h}$, и определить $x_i = a + hi$, $y_i = f(x_i)$.
Реализуем несколько операций над этой функцией.

\section{Реализация нахождения методов производной при фиксированном шаге}

Аналитически производная определяется следующим образом:
$$f'(x)=\lim_{h \to 0} \frac{f(x+h)-f(x)}{h}$$
В силу аппаратных ограничений мы не можем вычислить этот предел с математической точностью.
Что можно сделать, так это зафиксировать какое-то малое значение $h$.
Определим $h$ как \textit{шаг сетки}. Отсюда мы сразу же получаем первую формулу:
$$f'(x) \approx \frac{f(x+h)-f(h)}{h}$$
Данная формула называется \textit{правой разностной производной}. Примем во внимание тот факт,
что в общем случае, при приближении $h$ к нулю, $h$ необязательно быть положительным числом.
Таким образом мы получаем \textit{левую разностную производную}:
$$f'(x) \approx \frac{f(x)-f(x-h)}{h}$$
Для увеличения точности можно использовать формулу с тремя узлами:
$$f'(x) = \frac{f(x+h) - f(x-h)}{2h}$$
Значения производной в крайних точках определим следующим образом:
\begin{align}
    f'(a) &= \frac{-3f(a) + 4f(a + h) - f(a + 2h)}{2h} \\
    f'(b) &= \frac{3f(b - 2h) - 4f(b - h) + f(b)}{2h}
\end{align}

\def\Fi{x^2}
\def\Fii{e^x}

Выберем две функции: $f_1(x) = \Fi, f_2(x) = \Fii$. Будем находить производные
на отрезке $[0, 1]$ с шагом $0.1$. И вычислять для каждого значения среднеквадратичное отклонение $\sigma$ от аналитически высчитаного.

\begin{figure}[htpb]
    \begin{center}
        \begin{tikzpicture}
            \begin{axis}[restrict x to domain = 0:1,
                         legend entries = {$\Fi$, $\Fii$},
                         legend pos = south east,
                         yminorgrids = false,
                         ymajorgrids = false,
                         no marks,
                         grid style = { dashed }]
                \addplot {x^2};
                \addplot {exp(x)};
            \end{axis}
        \end{tikzpicture}
    \end{center}
    \caption{Графики выбранных функций}%
\end{figure}

\begin{table}[htp]
    \centering
    \caption{Вычисленные значения производных функции $\Fi$}
    \label{tab:Fi}
    \begin{tabular}{r|c|c|c|c|c}
        $x$ & Лев. разн. & Прав. разн. & Три узла & Аналитически & $\sigma$ \\
        \hline
        0.0 & -0.1 & 0.1 & 0.0 & 0.0 & 0.08165 \\
        0.1 & 0.1 & 0.3 & 0.2 & 0.2 & 0.08165 \\
        0.2 & 0.3 & 0.5 & 0.4 & 0.4 & 0.08165 \\
        0.3 & 0.5 & 0.7 & 0.6 & 0.6 & 0.08165 \\
        0.4 & 0.7 & 0.9 & 0.8 & 0.8 & 0.08165 \\
        0.5 & 0.9 & 1.1 & 1.0 & 1.0 & 0.08165 \\
        0.6 & 1.1 & 1.3 & 1.2 & 1.2 & 0.08165 \\
        0.7 & 1.3 & 1.5 & 1.4 & 1.4 & 0.08165 \\
        0.8 & 1.5 & 1.7 & 1.6 & 1.6 & 0.08165 \\
        0.9 & 1.7 & 1.9 & 1.8 & 1.8 & 0.08165 \\
        1.0 & 1.9 & 2.1 & 2.0 & 2.0 & 0.08165 \\
        \hline
    \end{tabular}
\end{table}

\begin{table}[htp]
    \centering
    \caption{Вычисленные значения производных функции $\Fii$}
    \label{tab:Fii}
    \begin{tabular}{r|c|c|c|c|c}
        $x$ & Лев. разн. & Прав. разн. & Три узла & Аналитически & $\sigma$ \\
        \hline
        0.0 & 0.95163 & 1.05171 & 0.99640 & 1.00000 & 0.04093 \\
        0.1 & 1.05171 & 1.16232 & 1.10701 & 1.10517 & 0.04519 \\
        0.2 & 1.16232 & 1.28456 & 1.22344 & 1.22140 & 0.04995 \\
        0.3 & 1.28456 & 1.41966 & 1.35211 & 1.34986 & 0.05520 \\
        0.4 & 1.41966 & 1.56897 & 1.49431 & 1.49182 & 0.06100 \\
        0.5 & 1.56897 & 1.73398 & 1.65147 & 1.64872 & 0.06742 \\
        0.6 & 1.73398 & 1.91634 & 1.82516 & 1.82212 & 0.07451 \\
        0.7 & 1.91634 & 2.11788 & 2.01711 & 2.01375 & 0.08235 \\
        0.8 & 2.11788 & 2.34062 & 2.22925 & 2.22554 & 0.09101 \\
        0.9 & 2.34062 & 2.58679 & 2.46370 & 2.45960 & 0.10058 \\
        1.0 & 2.58679 & 2.85884 & 2.70987 & 2.71828 & 0.11123 \\
        \hline
    \end{tabular}
\end{table}

\begin{figure}[htpb]
    \begin{center}
        \begin{tikzpicture}
            \begin{axis}[xlabel = $n$,
                ylabel = $\sigma$,
                legend entries={$\sigma_{\Fi}$, $\sigma_{\Fii}$}]
                \addplot table {
                        10 0.08164965809277268
                        20 0.040824829046386284
                        40 0.020412414523193083
                        80 0.01020620726159653
                        160 0.005103103630798458
                    };
                \addplot table {
                        10 0.07085295201908055
                        20 0.03523355290230071
                        40 0.017574973571553184
                        80 0.008777788902433966
                        160 0.0043865604063861915
                    };
            \end{axis}
        \end{tikzpicture}
    \end{center}
    \caption{График зависимости среднего квадратичного от количества шагов}%
    \label{fig:dev}
\end{figure}

В таблицах \ref{tab:Fi} и \ref{tab:Fii} левые разностные производные меньше,
чем аналитически посчитанные, в то же время правые разностные производные - больше.
Метод трёх узлов точнее вычисляет производную засчёт того, что мы рассматриваем
значения производных в двух направлениях окрестности точки.

Как можно заметить на графике \ref{fig:dev}, зависимость $\sigma$ от $n$ обратная.
Учитывая, что $n = \frac{b-a}{h}$, следует, что $\sigma$ линейно зависит от $h$.

\end{document}
